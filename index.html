<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Feliz D√≠a de la Noviaüåπ</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Playwrite+IN:wght@400&display=swap');
    @import url('https://fonts.googleapis.com/css2?family=Sour+Gummy&display=swap');
 
    body {
      margin: 0;
      overflow: hidden;
      background-color: #0d0000;
      color: #fff;
      height: 100vh;
      position: relative;
      box-sizing: border-box;
      /* Configuraci√≥n responsiva para alineaci√≥n */
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
    }

    /* M√≥viles: elementos alineados arriba */
    @media screen and (max-width: 767px) {
      body {
        align-items: flex-start;
        justify-content: center;
        padding-top: 5vh;
      }
    }

    /* Pantalla de inicio */
    .start-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #0d0000;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      cursor: pointer;
      transition: opacity 0.5s ease-out;
      user-select: none;
    }

    .start-screen.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .start-text {
      font-family: "Sour Gummy", sans-serif;
      font-size: clamp(1.5rem, 5vw, 2.5rem);
      color: #ff5c5c;
      text-shadow: 0 0 10px #ff5c5c;
      margin-bottom: 30px;
      text-align: center;
    }

    .heart-icon {
      font-size: clamp(3rem, 10vw, 5rem);
      color: #ff5c5c;
      animation: heartbeat 1.5s ease-in-out infinite;
      filter: drop-shadow(0 0 15px #ff5c5c);
    }

    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.2); }
    }

    /* Indicador de audio para m√≥viles */
    .audio-prompt {
      position: absolute;
      bottom: 20%;
      font-family: "Sour Gummy", sans-serif;
      font-size: clamp(0.9rem, 3vw, 1.2rem);
      color: #ff8585;
      text-align: center;
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.7; }
      50% { opacity: 1; }
    }

    canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
    }

    .vignette-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(ellipse at center, rgba(13, 0, 0, 0) 0%, rgba(13, 0, 0, 0.7) 100%);
      z-index: 1;
      pointer-events: none;
    }

    .content {
      position: relative;
      z-index: 2;
      text-align: center;
      padding: 10px;
      pointer-events: none;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      max-width: 90%;
    }

    h1 {
      font-family: "Playwrite IN", cursive;
      font-weight: 400;
      color: #ff5c5c;
      text-shadow: 0 0 10px #ff5c5c, 0 0 25px #ff1f1f;
      margin: 0;
      font-size: clamp(2.5rem, 8vw, 3.5rem);
    }

    img {
      margin: 20px 0;
      filter: drop-shadow(0 0 15px #ff5c5c) drop-shadow(0 0 35px rgba(255, 20, 20, 0.8));
      animation: sway 2s ease-in-out infinite; 
      transform-origin: bottom center;
      width: clamp(180px, 40vw, 280px);
    }

    @keyframes sway {
      0%, 100% { transform: rotate(-2deg); }
      50% { transform: rotate(2deg); }
    }

    p {
      font-family: "Sour Gummy", sans-serif;
      color: #f5e6e6;
      text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
      margin: 0 auto;
      font-size: clamp(1.3rem, 4vw, 1.6rem);
      line-height: 1.4;
    }
    
    .date {
      font-family: "Sour Gummy", sans-serif;
      color: #a08f8f;
      margin-top: 15px;
      font-size: clamp(1rem, 3vw, 1.2rem);
    }

    /* Media queries para ajustes espec√≠ficos en PC */
    @media screen and (min-width: 768px) {
      .content {
        max-width: 70%;
      }
      
      h1 {
        font-size: 3.2rem;
      }
      
      img {
        width: 250px;
      }
      
      p {
        font-size: 1.5rem;
        max-width: 600px;
      }
      
      .date {
        font-size: 1.1rem;
      }
    }

    /* Ajustes para pantallas muy grandes */
    @media screen and (min-width: 1200px) {
      .content {
        max-width: 60%;
      }
    }

    /* Ocultar elementos del navegador */
    * {
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
  </style>
</head>
<body>
  <!-- Pantalla de inicio -->
  <div class="start-screen" id="startScreen">
    <div class="start-text">Toca para iniciar</div>
    <div class="heart-icon">‚ô•</div>
  </div>

  <canvas id="canvas"></canvas>
  <div class="vignette-overlay"></div>
  
  <div class="content">
    <h1>¬°Feliz D√≠a de la Noviaüåπ!</h1>
    <img src="assets/roses.png" alt="Rosas">
    <div class="message-container">
      <p>Con tanta gente en el mundo fue la mas linda casualidad encontrarte, eres la mejor novia que existe, te amo demasiado‚ù§Ô∏è</p>
      <p class="date">01-08-25</p>
    </div>
  </div>

  <!-- Audio para la m√∫sica de fondo -->
  <audio id="backgroundMusic" loop preload="auto" playsInline>
    <source src="assets/sound.mp3" type="audio/mpeg">
    <source src="assets/sound.ogg" type="audio/ogg">
    <source src="assets/sound.wav" type="audio/wav">
  </audio>

  <script>
    // ================== SISTEMA DE PROTECCI√ìN ROBUSTO ==================
    
    // Bloquear teclas de desarrollador
    document.addEventListener('keydown', function(e) {
      // F12
      if (e.keyCode === 123) {
        e.preventDefault();
        return false;
      }
      
      // Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+Shift+C, Ctrl+U, Ctrl+S, Ctrl+A, Ctrl+P
      if (e.ctrlKey && (
        (e.shiftKey && (e.keyCode === 73 || e.keyCode === 74 || e.keyCode === 67)) || // I, J, C
        e.keyCode === 85 || // U
        e.keyCode === 83 || // S
        e.keyCode === 65 || // A
        e.keyCode === 80    // P
      )) {
        e.preventDefault();
        return false;
      }
      
      // Cmd+Option+I, Cmd+Option+J, Cmd+Option+C (Mac)
      if (e.metaKey && e.altKey && (e.keyCode === 73 || e.keyCode === 74 || e.keyCode === 67)) {
        e.preventDefault();
        return false;
      }
      
      // Cmd+U, Cmd+S (Mac)
      if (e.metaKey && (e.keyCode === 85 || e.keyCode === 83)) {
        e.preventDefault();
        return false;
      }
    });

    // Bloquear men√∫ contextual (click derecho)
    document.addEventListener('contextmenu', function(e) {
      e.preventDefault();
      return false;
    });

    // Bloquear selecci√≥n de texto
    document.addEventListener('selectstart', function(e) {
      e.preventDefault();
      return false;
    });

    // Bloquear arrastrar elementos
    document.addEventListener('dragstart', function(e) {
      e.preventDefault();
      return false;
    });

    // Detectar herramientas de desarrollador abiertas
    let devtools = { open: false, orientation: null };
    const threshold = 160;

    setInterval(function() {
      const widthThreshold = window.outerWidth - window.innerWidth > threshold;
      const heightThreshold = window.outerHeight - window.innerHeight > threshold;
      const orientation = widthThreshold ? 'vertical' : 'horizontal';

      if (!(heightThreshold && widthThreshold) && 
          ((window.Firebug && window.Firebug.chrome && window.Firebug.chrome.isInitialized) || 
           widthThreshold || heightThreshold)) {
        
        if (!devtools.open || devtools.orientation !== orientation) {
          devtools.open = true;
          devtools.orientation = orientation;
          // Redirigir o cerrar si se detectan herramientas
          window.location.href = 'about:blank';
        }
      } else {
        devtools.open = false;
        devtools.orientation = null;
      }
    }, 500);

    // Bloquear consola mediante console.clear continuo
    if (typeof console !== 'undefined') {
      setInterval(function() {
        console.clear();
      }, 1000);
    }

    // Reemplazar console con funciones vac√≠as
    const noop = () => {};
    ['log', 'debug', 'info', 'warn', 'error', 'assert', 'dir', 'dirxml', 
     'group', 'groupEnd', 'time', 'timeEnd', 'count', 'trace', 'profile', 'profileEnd']
    .forEach(method => {
      if (console[method]) {
        console[method] = noop;
      }
    });

    // ================== C√ìDIGO PRINCIPAL ==================
    
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const startScreen = document.getElementById('startScreen');
    const backgroundMusic = document.getElementById('backgroundMusic');
    const audioPrompt = document.getElementById('audioPrompt');
    
    let hearts = [];
    let particles = [];
    let animationStarted = false;
    let audioContext = null;
    let isMobileDevice = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    
    // Colores y frases para el efecto de clic
    const fireworkColors = ['#ff4d4d', '#ff1493', '#ff85d1'];
    const fireworkPhrases = ['Mi Amor', 'Eres mi Todo', 'Siempre Juntos', 'Te Adoro'];
    const HEART_COUNT = 60;
    const TEXT_PARTICLES_ON_CLICK = 5;
    const HEART_PARTICLES_ON_CLICK = 15;

    // Funci√≥n para detectar si es dispositivo m√≥vil
    function isMobile() {
      return window.innerWidth <= 767;
    }

    // ================== SISTEMA ROBUSTO DE AUDIO PARA M√ìVILES ==================
    
    function initAudioContext() {
      try {
        window.AudioContext = window.AudioContext || window.webkitAudioContext;
        audioContext = new AudioContext();
        return true;
      } catch (e) {
        console.log('AudioContext no soportado');
        return false;
      }
    }

    function resumeAudioContext() {
      if (audioContext && audioContext.state === 'suspended') {
        audioContext.resume();
      }
    }

    async function playAudioWithFallbacks() {
      try {
        // Configurar volumen
        backgroundMusic.volume = 0.7;
        
        // Intentar reproducir directamente
        const playPromise = backgroundMusic.play();
        
        if (playPromise !== undefined) {
          await playPromise;
          return true;
        }
      } catch (error) {
        console.log('Primer intento fall√≥:', error);
        
        // Fallback 1: Cargar y reproducir despu√©s de un peque√±o delay
        try {
          await new Promise(resolve => {
            backgroundMusic.addEventListener('canplaythrough', resolve, { once: true });
            backgroundMusic.load();
          });
          
          setTimeout(async () => {
            try {
              await backgroundMusic.play();
              return true;
            } catch (e) {
              console.log('Fallback 1 fall√≥:', e);
            }
          }, 100);
        } catch (e) {
          console.log('Fallback 1 fall√≥:', e);
        }
        
        // Fallback 2: Para m√≥viles - m√∫ltiples intentos
        if (isMobileDevice) {
          let attempts = 0;
          const maxAttempts = 5;
          
          const tryPlay = async () => {
            if (attempts >= maxAttempts) return false;
            attempts++;
            
            try {
              resumeAudioContext();
              backgroundMusic.currentTime = 0;
              await backgroundMusic.play();
              return true;
            } catch (e) {
              console.log(`Intento ${attempts} fall√≥:`, e);
              if (attempts < maxAttempts) {
                setTimeout(tryPlay, 200 * attempts);
              }
              return false;
            }
          };
          
          setTimeout(tryPlay, 300);
        }
      }
      
      return false;
    }

    // Funci√≥n para iniciar la experiencia
    async function startExperience() {
      if (animationStarted) return;
      
      animationStarted = true;
      
      // Inicializar AudioContext si es necesario
      if (isMobileDevice) {
        initAudioContext();
        resumeAudioContext();
      }
      
      // Ocultar pantalla de inicio
      startScreen.classList.add('hidden');
      
      // Intentar reproducir audio con sistema robusto
      setTimeout(async () => {
        await playAudioWithFallbacks();
        
        // Intentos adicionales para m√≥viles
        if (isMobileDevice && backgroundMusic.paused) {
          for (let i = 0; i < 3; i++) {
            setTimeout(async () => {
              try {
                resumeAudioContext();
                await backgroundMusic.play();
              } catch (e) {
                console.log(`Intento adicional ${i + 1} fall√≥`);
              }
            }, 500 * (i + 1));
          }
        }
      }, 200);
      
      // Limpiar pantalla de inicio
      setTimeout(() => {
        startScreen.style.display = 'none';
      }, 500);
    }

    // Event listeners para la pantalla de inicio - m√∫ltiples eventos para m√°xima compatibilidad
    const startEvents = ['click', 'touchstart', 'touchend', 'mousedown', 'keydown'];
    startEvents.forEach(eventType => {
      startScreen.addEventListener(eventType, startExperience, { passive: false });
    });

    // Event listeners adicionales para asegurar reproducci√≥n en m√≥viles
    document.addEventListener('touchstart', resumeAudioContext, { passive: true, once: true });
    document.addEventListener('touchend', resumeAudioContext, { passive: true, once: true });
    document.addEventListener('click', resumeAudioContext, { passive: true, once: true });

    // ================== C√ìDIGO DE ANIMACI√ìN ==================

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    function drawBackground() {
      ctx.fillStyle = '#0d0000';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
    }

    class Heart {
      constructor() {
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.size = Math.random() * 30 + 15;
        this.speedY = Math.random() * 1.5 + 0.5;
        this.opacity = Math.random() * 0.4 + 0.1;
      }

      draw() {
        ctx.fillStyle = `rgba(255, 77, 77, ${this.opacity})`;
        ctx.beginPath();
        ctx.moveTo(this.x, this.y);
        ctx.bezierCurveTo(this.x - this.size * 0.5, this.y - this.size * 0.5, this.x - this.size, this.y + this.size * 0.2, this.x, this.y + this.size * 0.8);
        ctx.bezierCurveTo(this.x + this.size, this.y + this.size * 0.2, this.x + this.size * 0.5, this.y - this.size * 0.5, this.x, this.y);
        ctx.fill();
      }

      update() {
        this.y += this.speedY;
        if (this.y > canvas.height + this.size) {
          this.y = -this.size;
          this.x = Math.random() * canvas.width;
        }
      }
    }

    class Particle {
      constructor(x, y, isText = false) {
        this.x = x;
        this.y = y;
        this.isText = isText;
        this.life = 100;
        const multiplier = isMobile() ? 1 : 1.8;
        this.vx = (Math.random() - 0.5) * 5 * multiplier;
        this.vy = (Math.random() - 0.5) * 5 * multiplier;
        this.opacity = 1;
        this.color = fireworkColors[Math.floor(Math.random() * fireworkColors.length)];
        
        if (isText) {
          this.text = fireworkPhrases[Math.floor(Math.random() * fireworkPhrases.length)];
          this.size = isMobile() ? 25 : 35;
        } else {
          this.size = isMobile() ? Math.random() * 10 + 4 : Math.random() * 15 + 8;
        }
      }

      draw() {
        ctx.save();
        ctx.globalAlpha = this.opacity;
        ctx.fillStyle = this.color;
        
        if (this.isText) {
          ctx.shadowColor = this.color;
          ctx.shadowBlur = 20;
          ctx.font = `${this.size}px "Sour Gummy", sans-serif`;
          ctx.fillText(this.text, this.x, this.y);
        } else {
          ctx.beginPath();
          ctx.moveTo(this.x, this.y + this.size * 0.25);
          ctx.quadraticCurveTo(this.x, this.y, this.x + this.size * 0.35, this.y);
          ctx.quadraticCurveTo(this.x + this.size * 0.7, this.y, this.x + this.size * 0.7, this.y + this.size * 0.25);
          ctx.quadraticCurveTo(this.x + this.size * 0.7, this.y + this.size * 0.5, this.x + this.size * 0.35, this.y + this.size * 0.8);
          ctx.quadraticCurveTo(this.x, this.y + this.size * 0.5, this.x, this.y + this.size * 0.25);
          ctx.fill();
        }
        ctx.restore();
      }

      update() {
        this.x += this.vx;
        this.y += this.vy;
        this.vx *= 0.98;
        this.vy *= 0.98;
        this.life--;
        if (this.life < 50) {
          this.opacity = this.life / 50;
        }
      }
    }

    // Inicializar corazones
    for (let i = 0; i < HEART_COUNT; i++) {
      hearts.push(new Heart());
    }

    // Event listeners para los clics (fuegos artificiales)
    function handleClick(e) {
      if (!animationStarted) return;
      
      const rect = canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      
      const textParticles = isMobile() ? TEXT_PARTICLES_ON_CLICK : TEXT_PARTICLES_ON_CLICK * 1.5;
      const heartParticles = isMobile() ? HEART_PARTICLES_ON_CLICK : HEART_PARTICLES_ON_CLICK * 1.8;
      
      for (let i = 0; i < textParticles; i++) {
        particles.push(new Particle(x, y, true));
      }
      for (let i = 0; i < heartParticles; i++) {
        particles.push(new Particle(x, y));
      }
    }

    function handleTouch(e) {
      if (!animationStarted) return;
      
      e.preventDefault();
      const rect = canvas.getBoundingClientRect();
      const touch = e.touches[0] || e.changedTouches[0];
      const x = touch.clientX - rect.left;
      const y = touch.clientY - rect.top;
      
      for (let i = 0; i < TEXT_PARTICLES_ON_CLICK; i++) {
        particles.push(new Particle(x, y, true));
      }
      for (let i = 0; i < HEART_PARTICLES_ON_CLICK; i++) {
        particles.push(new Particle(x, y));
      }
    }

    canvas.addEventListener('click', handleClick);
    canvas.addEventListener('touchstart', handleTouch, { passive: false });

    function animate() {
      if (!animationStarted) {
        requestAnimationFrame(animate);
        return;
      }

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawBackground();

      hearts.forEach(heart => {
        heart.draw();
        heart.update();
      });
      
      particles = particles.filter(p => p.life > 0 && p.opacity > 0.01);
      particles.forEach(particle => {
        particle.draw();
        particle.update();
      });

      requestAnimationFrame(animate);
    }

    animate();

    // ================== PROTECCIONES ADICIONALES ==================
    
    // Bloquear zoom
    document.addEventListener('wheel', function(e) {
      if (e.ctrlKey) {
        e.preventDefault();
      }
    }, { passive: false });

    // Bloquear gestos de zoom en m√≥viles
    document.addEventListener('gesturestart', function(e) {
      e.preventDefault();
    });

    document.addEventListener('gesturechange', function(e) {
      e.preventDefault();
    });

    document.addEventListener('gestureend', function(e) {
      e.preventDefault();
    });

    // Limpiar intervalos al salir
    window.addEventListener('beforeunload', function() {
      if (backgroundMusic) {
        backgroundMusic.pause();
      }
    });
  </script>
</body>
</html>
